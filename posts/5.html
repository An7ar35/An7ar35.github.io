<!-- Generated with Blogator 1.3.2 (https://an7ar35.bitbucket.io) -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Security-Policy" content="script-src-elem 'self' 'unsafe-inline' 'unsafe-eval';">
    <title>EAD | Writings</title>
    <link rel="shortcut icon" type="image/x-icon" href="../favicon.ico" />
    <link rel="stylesheet" type="text/css" href="../css/main.css" />
    <link rel="stylesheet" type="text/css" href="../css/blogator/main.css" />
</head>
    <body>
        <div class="header">
            <div><img src="../img/tree-left.svg" alt="left tree"/></div>
            <div>
                <div class="site-title">Es' corner</div>
                <div class="site-micro-title">Just another keyboard-enthusiastic hominid.</div>
            </div>
            <div><img src="../img/tree-right.svg" alt="right tree"/></div>
        </div>
        <nav class="navigation">
            <ul>
                <li class="active">
                    <a class="nav-writings" href="../index.html">
                        <div class="nav-icon"></div>
                        <div class="nav-text">Home</div>
                    </a>
                </li>
                <li>
                    <a class="nav-projects" href="../pages/projects/personal.html">
                        <div class="nav-icon"></div>
                        <div class="nav-text">Projects</div>
                    </a>
                </li>
                <li>
                    <a class="nav-contact" href="../pages/contact.html">
                        <div class="nav-icon"></div>
                        <div class="nav-text">Contact</div>
                    </a>
                </li>
            </ul>
        </nav>
        <script src="../js/sticky-top-navbar.js"></script>

        <div class="breadcrumb">
        	<ul>
        		<li><a href="../index.html">Home</a></li>
        		<li><a href="../index/by_date/0.html">Posts</a></li>
        		<li>Design Pattern: Object Pool</li>
        	</ul>
        </div>

        <div class="content-h">
            <div class="left-col">
                <div class="post-content">

<article>
    <div>
        <h1><span class="title">Design Pattern: Object Pool</span></h1>
        <time datetime="2018-08-27">27 August 2018</time>
        <div class="authors">
            <span class="author">Es</span>
        </div>
        <div class="tags">
            <span class="tag">Design Patterns</span>
            <span class="tag">Notes</span>
        </div>
    </div>
    <div class="post-text">

        <p>Re-usable instances of a Class.</p>

        <p><span class="bold">Type:</span> Creational.</p>

        <figure class="right half-width">
            <a href="../source/2018/Design%20Patterns%20-%20Object%20Pool/object_pool.png">
                <img src="../source/2018/Design%20Patterns%20-%20Object%20Pool/object_pool.png" alt="Object Pool UML" />
            </a>
            <figcaption>Object Pool UML</figcaption>
        </figure>

        <p>An object pool essentially keeps a set of re-usable instantiated objects in a cache (pool) where each is put back and reset after use. This is to avoid the object creation/destruction overheads.</p>

        <p>For example, a good candidate for such a pattern is a large and/or complex class that is constantly being instantiated and creates a performance bottleneck because of this.</p>

        <p>Stateful objects must be <span style="color: red">reset</span> when released back into the pool and behaviour must be defined when a process tries to fetch an object from an empty pool (e.g.: throw exception, create instances, wait...).</p>

        <h2>C++11</h2>

        <p>In C++ object pooling can be easily achieved by using <code class="inline cpp">std::unique_ptr</code> and a custom deleter. Pool release is then auto-magically done even when calling <code class="inline cpp">std::unique_ptr.reset()</code> on the pooled object pointer.</p>

        <figure class="center">
            <a href="../source/2018/Design%20Patterns%20-%20Object%20Pool/object_pool_cpp.png">
                <img src="../source/2018/Design%20Patterns%20-%20Object%20Pool/object_pool_cpp.png" alt="Object Pool in C++ UML" />
            </a>
            <figcaption>C++ Object Pool UML (Class diag.)</figcaption>
        </figure>

<div class="code-wrap">
<code class="block cpp">class Deleter {
    public:
        explicit Deleter( std::weak_ptr&lt;ObjectPool*&gt; pool ) :
            _pool( pool )
        {}

        void operator()( Object *ptr ) {
            if( auto pool_ptr = _pool.lock() ) {
                /* Pool exists so add pointer back to pool */
                ( *pool_ptr.get() )->release( std::unique_ptr&lt;Object&gt;{ ptr } );
            } else {
                /* Pool has been destroyed so default deleter is used instead */
                std::default_delete&lt;Object&gt;{}( ptr );
            }
        }

    private:
        std::weak_ptr&lt;ObjectPool*&gt; _pool; /* non-owning smart pointer */
};
</code></div>
        <span class="caption-bottom">Custom deleter implementation for Pool objects</span>

        <h2>Java</h2>

        <p>Since Java is a Garbage Collected language the pool's object acquisition must be explicit and disposal must be used to "return" the borrowed object to the pool.</p>

        <p>Generally, this pattern should be avoided as memory allocation and garbage collection in modern JVMs is very cheap for short lived objects. Exceptions are when object creation cost is very high (threads, network or db connections...).</p>

    </div>
</article>
                </div>
            </div>
            <div class="right-col">
                <div class="page-nav">
                	<ul>
                		<li class="first"><a href="1.html">|&#9664;</a></li>
                		<li class="prev"><a rel="prev" href="4.html">&#9664;</a></li>
                		<li class="curr">5 / 29</li>
                		<li class="next"><a rel="next" href="6.html">&#9654;</a></li>
                		<li class="last"><a href="29.html">&#9654;|</a></li>
                	</ul>
                </div>

                <div>
                    <h2>By Date</h2>
                    <div class="index-pane-dates">
                    		<ol class="tree">
                    			<li><label for="checkbox_2021">2021</label><input type="checkbox" id="checkbox_2021"/>
                    				<ol>
                    					<li><label for="checkbox_202108">August</label><input type="checkbox" id="checkbox_202108"/>
                    						<ol>
                    							<li>12 <a href="29.html">Binary Search Algorithm</a></li>
                    						</ol>
                    					</li>
                    					<li><label for="checkbox_202107">July</label><input type="checkbox" id="checkbox_202107"/>
                    						<ol>
                    							<li>19 <a href="28.html">Retrospective: cTune v1.0</a></li>
                    							<li>10 <a href="27.html">Circular Buffer</a></li>
                    						</ol>
                    					</li>
                    					<li><label for="checkbox_202106">June</label><input type="checkbox" id="checkbox_202106"/>
                    						<ol>
                    							<li>30 <a href="26.html">cTune v1.0: Part 3 - Frontstage</a></li>
                    							<li>25 <a href="25.html">cTune v1.0: Part 2 - Backstage</a></li>
                    							<li>16 <a href="24.html">cTune v1.0: Part 1 - Design</a></li>
                    							<li>15 <a href="23.html">cTune v1.0 released</a></li>
                    						</ol>
                    					</li>
                    				</ol>
                    			</li>
                    			<li><label for="checkbox_2020">2020</label><input type="checkbox" id="checkbox_2020"/>
                    				<ol>
                    					<li><label for="checkbox_202006">June</label><input type="checkbox" id="checkbox_202006"/>
                    						<ol>
                    							<li>16 <a href="22.html">Indexed search with Javascript</a></li>
                    							<li>03 <a href="21.html">Character encoding primer</a></li>
                    						</ol>
                    					</li>
                    					<li><label for="checkbox_202005">May</label><input type="checkbox" id="checkbox_202005"/>
                    						<ol>
                    							<li>27 <a href="20.html">Blogator v1.3 released</a></li>
                    							<li>07 <a href="19.html">Blogator v1.2 released</a></li>
                    						</ol>
                    					</li>
                    					<li><label for="checkbox_202004">April</label><input type="checkbox" id="checkbox_202004"/>
                    						<ol>
                    							<li>22 <a href="18.html">HDD diagnosis and recovery tools</a></li>
                    						</ol>
                    					</li>
                    					<li><label for="checkbox_202003">March</label><input type="checkbox" id="checkbox_202003"/>
                    						<ol>
                    							<li>27 <a href="17.html">Coronavirus info and form fetcher script for the French gov. page</a></li>
                    							<li>24 <a href="16.html">A RaspberryPi Git server</a></li>
                    						</ol>
                    					</li>
                    					<li><label for="checkbox_202002">February</label><input type="checkbox" id="checkbox_202002"/>
                    						<ol>
                    							<li>23 <a href="15.html">CMake Variable Injection</a></li>
                    							<li>14 <a href="14.html">Android upgrade woes</a></li>
                    							<li>11 <a href="13.html">Basics of the Linux terminal and tools</a></li>
                    						</ol>
                    					</li>
                    				</ol>
                    			</li>
                    			<li><label for="checkbox_2019">2019</label><input type="checkbox" id="checkbox_2019"/>
                    				<ol>
                    					<li><label for="checkbox_201910">October</label><input type="checkbox" id="checkbox_201910"/>
                    						<ol>
                    							<li>10 <a href="12.html">C++ Resource Acquisition Is Initialization (RAII)</a></li>
                    						</ol>
                    					</li>
                    					<li><label for="checkbox_201908">August</label><input type="checkbox" id="checkbox_201908"/>
                    						<ol>
                    							<li>20 <a href="11.html">Retrospective: Blogator v1.0</a></li>
                    							<li>13 <a href="10.html">Blogator v1.0 released</a></li>
                    						</ol>
                    					</li>
                    					<li><label for="checkbox_201901">January</label><input type="checkbox" id="checkbox_201901"/>
                    						<ol>
                    							<li>06 <a href="9.html">Terminal plot-graphs with braille characters</a></li>
                    							<li>02 <a href="8.html">Creating bitmaps using braille characters</a></li>
                    						</ol>
                    					</li>
                    				</ol>
                    			</li>
                    			<li><label for="checkbox_2018">2018</label><input type="checkbox" checked  id="checkbox_2018"/>
                    				<ol>
                    					<li><label for="checkbox_201811">November</label><input type="checkbox" id="checkbox_201811"/>
                    						<ol>
                    							<li>30 <a href="7.html">Maximum value in a Sliding Window</a></li>
                    						</ol>
                    					</li>
                    					<li><label for="checkbox_201809">September</label><input type="checkbox" id="checkbox_201809"/>
                    						<ol>
                    							<li>11 <a href="6.html">C++ Raw and Smart Pointers</a></li>
                    						</ol>
                    					</li>
                    					<li><label for="checkbox_201808">August</label><input type="checkbox" checked  id="checkbox_201808"/>
                    						<ol>
                    							<li>27 <a class="current-post" href="5.html">Design Pattern: Object Pool</a></li>
                    							<li>14 <a href="4.html">Design Pattern: Singleton</a></li>
                    						</ol>
                    					</li>
                    					<li><label for="checkbox_201803">March</label><input type="checkbox" id="checkbox_201803"/>
                    						<ol>
                    							<li>18 <a href="3.html">Python package based app structure</a></li>
                    						</ol>
                    					</li>
                    					<li><label for="checkbox_201801">January</label><input type="checkbox" id="checkbox_201801"/>
                    						<ol>
                    							<li>27 <a href="2.html">Working out coordinates using distances</a></li>
                    						</ol>
                    					</li>
                    				</ol>
                    			</li>
                    			<li><label for="checkbox_2017">2017</label><input type="checkbox" id="checkbox_2017"/>
                    				<ol>
                    					<li><label for="checkbox_201712">December</label><input type="checkbox" id="checkbox_201712"/>
                    						<ol>
                    							<li>30 <a href="1.html">Arch Linux on a MacBook Pro 2015</a></li>
                    						</ol>
                    					</li>
                    				</ol>
                    			</li>
                    		</ol>
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <div>
                <div>
                    <span class="footer-avatar"><img src="../img/kitteh.jpg" alt="logo"></span>
                    An7ar35, 2018-21
                </div>
            </div>
        </footer>
    </body>
</html>
