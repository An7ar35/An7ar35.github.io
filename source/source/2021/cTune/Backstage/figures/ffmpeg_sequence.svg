<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1588px" preserveAspectRatio="none" style="width:969px;height:1588px;background:#FFFFFF;" version="1.1" viewBox="0 0 969 1588" width="969px" zoomAndPan="magnify"><defs><filter height="300%" id="f1opb2z0wqnf34" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#F5DEB3" height="1576.1016" style="stroke:#A80036;stroke-width:1.0;" width="395" x="181.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="46" x="353.5" y="18.0669">Player</text><rect fill="#7FFFD4" height="1576.1016" style="stroke:#A80036;stroke-width:1.0;" width="317.5" x="578.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="96" x="686.75" y="18.0669">Audio Output</text><rect fill="#FFFFFF" filter="url(#f1opb2z0wqnf34)" height="1431.7813" style="stroke:#A80036;stroke-width:1.0;" width="10" x="46" y="86.7266"/><rect fill="#FFFFFF" filter="url(#f1opb2z0wqnf34)" height="1410.6484" style="stroke:#A80036;stroke-width:1.0;" width="10" x="232" y="107.8594"/><rect fill="#FFFFFF" filter="url(#f1opb2z0wqnf34)" height="1159.7188" style="stroke:#A80036;stroke-width:1.0;" width="10" x="506" y="217.2578"/><rect fill="#FFFFFF" filter="url(#f1opb2z0wqnf34)" height="959.7891" style="stroke:#A80036;stroke-width:1.0;" width="10" x="600.5" y="543.7188"/><rect fill="#FFFFFF" filter="url(#f1opb2z0wqnf34)" height="891.5234" style="stroke:#A80036;stroke-width:1.0;" width="10" x="834.5" y="596.9844"/><rect fill="#FFFFFF" filter="url(#f1opb2z0wqnf34)" height="104.5313" style="stroke:#000000;stroke-width:2.0;" width="407" x="175.5" y="237.2578"/><rect fill="#FFFFFF" filter="url(#f1opb2z0wqnf34)" height="46.2656" style="stroke:#000000;stroke-width:2.0;" width="407" x="175.5" y="355.7891"/><rect fill="#FFFFFF" filter="url(#f1opb2z0wqnf34)" height="75.3984" style="stroke:#000000;stroke-width:2.0;" width="407" x="175.5" y="416.0547"/><rect fill="#FFFFFF" filter="url(#f1opb2z0wqnf34)" height="264.1953" style="stroke:#000000;stroke-width:2.0;" width="736.5" x="175.5" y="505.4531"/><rect fill="#FFFFFF" filter="url(#f1opb2z0wqnf34)" height="161.7969" style="stroke:#000000;stroke-width:2.0;" width="329.5" x="572.5" y="558.7188"/><rect fill="#ADD8E6" filter="url(#f1opb2z0wqnf34)" height="726.8594" style="stroke:#000000;stroke-width:2.0;" width="942" x="10" y="783.6484"/><rect fill="#FFFFFF" filter="url(#f1opb2z0wqnf34)" height="387.7266" style="stroke:#000000;stroke-width:2.0;" width="786.5" x="155.5" y="807.7813"/><rect fill="#FFFFFF" filter="url(#f1opb2z0wqnf34)" height="356.5938" style="stroke:#000000;stroke-width:2.0;" width="766.5" x="165.5" y="831.9141"/><rect fill="#FFFFFF" filter="url(#f1opb2z0wqnf34)" height="267.1953" style="stroke:#000000;stroke-width:2.0;" width="746.5" x="175.5" y="885.1797"/><rect fill="#FFFFFF" filter="url(#f1opb2z0wqnf34)" height="148.6641" style="stroke:#000000;stroke-width:2.0;" width="349.5" x="562.5" y="996.7109"/><rect fill="#FFFFFF" filter="url(#f1opb2z0wqnf34)" height="46.2656" style="stroke:#000000;stroke-width:2.0;" width="329.5" x="572.5" y="1020.8438"/><rect fill="#FFB6C1" height="193.6016" style="stroke:none;stroke-width:1.0;" width="942" x="10" y="1316.9063"/><rect fill="#FFFFFF" filter="url(#f1opb2z0wqnf34)" height="164.7969" style="stroke:#000000;stroke-width:2.0;" width="736.5" x="175.5" y="1338.7109"/><rect fill="#FFFFFF" filter="url(#f1opb2z0wqnf34)" height="75.3984" style="stroke:#000000;stroke-width:2.0;" width="329.5" x="572.5" y="1421.1094"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="51" x2="51" y1="76.7266" y2="1527.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="236.5" x2="236.5" y1="76.7266" y2="1527.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="510.5" x2="510.5" y1="76.7266" y2="1527.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="605.5" x2="605.5" y1="76.7266" y2="1527.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="839" x2="839" y1="76.7266" y2="1527.5078"/><rect fill="#FEFECE" filter="url(#f1opb2z0wqnf34)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="58" x="20" y="41.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="27" y="61.4248">cTune</text><rect fill="#FEFECE" filter="url(#f1opb2z0wqnf34)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="58" x="20" y="1526.5078"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="27" y="1546.5029">cTune</text><rect fill="#FEFECE" filter="url(#f1opb2z0wqnf34)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="99" x="185.5" y="41.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="192.5" y="61.4248">RadioPlayer</text><rect fill="#FEFECE" filter="url(#f1opb2z0wqnf34)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="99" x="185.5" y="1526.5078"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85" x="192.5" y="1546.5029">RadioPlayer</text><rect fill="#FEFECE" filter="url(#f1opb2z0wqnf34)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="119" x="449.5" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105" x="456.5" y="45.1279">FFMpeg library</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="487" y="61.4248">(avlib)</text><rect fill="#FEFECE" filter="url(#f1opb2z0wqnf34)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="119" x="449.5" y="1526.5078"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105" x="456.5" y="1546.5029">FFMpeg library</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="487" y="1562.7998">(avlib)</text><rect fill="#FEFECE" filter="url(#f1opb2z0wqnf34)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="42" x="582.5" y="41.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="589.5" y="61.4248">SDL</text><rect fill="#FEFECE" filter="url(#f1opb2z0wqnf34)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="42" x="582.5" y="1526.5078"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="589.5" y="1546.5029">SDL</text><rect fill="#FEFECE" filter="url(#f1opb2z0wqnf34)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="101" x="787" y="41.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="794" y="61.4248">SDL2 library</text><rect fill="#FEFECE" filter="url(#f1opb2z0wqnf34)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="101" x="787" y="1526.5078"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="794" y="1546.5029">SDL2 library</text><rect fill="#FFFFFF" filter="url(#f1opb2z0wqnf34)" height="1431.7813" style="stroke:#A80036;stroke-width:1.0;" width="10" x="46" y="86.7266"/><rect fill="#FFFFFF" filter="url(#f1opb2z0wqnf34)" height="1410.6484" style="stroke:#A80036;stroke-width:1.0;" width="10" x="232" y="107.8594"/><rect fill="#FFFFFF" filter="url(#f1opb2z0wqnf34)" height="1159.7188" style="stroke:#A80036;stroke-width:1.0;" width="10" x="506" y="217.2578"/><rect fill="#FFFFFF" filter="url(#f1opb2z0wqnf34)" height="959.7891" style="stroke:#A80036;stroke-width:1.0;" width="10" x="600.5" y="543.7188"/><rect fill="#FFFFFF" filter="url(#f1opb2z0wqnf34)" height="891.5234" style="stroke:#A80036;stroke-width:1.0;" width="10" x="834.5" y="596.9844"/><polygon fill="#A80036" points="220,103.8594,230,107.8594,220,111.8594,224,107.8594" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="56" x2="226" y1="107.8594" y2="107.8594"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="64" x="63" y="102.7935">init(..)</text><rect fill="#EEEEEE" filter="url(#f1opb2z0wqnf34)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="962" x="0" y="136.4258"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="962" y1="136.4258" y2="136.4258"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="962" y1="139.4258" y2="139.4258"/><rect fill="#EEEEEE" filter="url(#f1opb2z0wqnf34)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="126" x="418" y="125.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="107" x="424" y="141.9263">Start Playback</text><polygon fill="#A80036" points="220,176.125,230,180.125,220,184.125,224,180.125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="56" x2="226" y1="180.125" y2="180.125"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="152" x="63" y="175.0591">playRadioStream(..)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="242" x2="289" y1="204.2578" y2="204.2578"/><line style="stroke:#A80036;stroke-width:1.0;" x1="289" x2="289" y1="204.2578" y2="217.2578"/><line style="stroke:#A80036;stroke-width:1.0;" x1="248" x2="289" y1="217.2578" y2="217.2578"/><polygon fill="#A80036" points="258,213.2578,248,217.2578,258,221.2578,254,217.2578" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="254" y="199.1919">set state to</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="128" x="332" y="199.1919">PLAYBACK_CTRL_ON</text><path d="M175.5,237.2578 L379.5,237.2578 L379.5,244.2578 L369.5,254.2578 L175.5,254.2578 L175.5,237.2578 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="104.5313" style="stroke:#000000;stroke-width:2.0;" width="407" x="175.5" y="237.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="159" x="190.5" y="250.3247">1. setup stream input</text><polygon fill="#A80036" points="494,271.5234,504,275.5234,494,279.5234,498,275.5234" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="242" x2="500" y1="275.5234" y2="275.5234"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="184" x="249" y="270.4575">avformat_open_input(..)</text><polygon fill="#A80036" points="494,300.6563,504,304.6563,494,308.6563,498,304.6563" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="242" x2="500" y1="304.6563" y2="304.6563"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="232" x="249" y="299.5903">avformat_find_stream_info(..)</text><polygon fill="#A80036" points="494,329.7891,504,333.7891,494,337.7891,498,333.7891" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="242" x2="500" y1="333.7891" y2="333.7891"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="184" x="249" y="328.7231">av_find_best_stream(..)</text><path d="M175.5,355.7891 L371.5,355.7891 L371.5,362.7891 L361.5,372.7891 L175.5,372.7891 L175.5,355.7891 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="46.2656" style="stroke:#000000;stroke-width:2.0;" width="407" x="175.5" y="355.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="151" x="190.5" y="368.856">2. Setup input codec</text><polygon fill="#A80036" points="494,390.0547,504,394.0547,494,398.0547,498,394.0547" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="242" x2="500" y1="394.0547" y2="394.0547"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="136" x="249" y="388.9888">avcodec_open2(..)</text><path d="M175.5,416.0547 L365.5,416.0547 L365.5,423.0547 L355.5,433.0547 L175.5,433.0547 L175.5,416.0547 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="75.3984" style="stroke:#000000;stroke-width:2.0;" width="407" x="175.5" y="416.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="145" x="190.5" y="429.1216">3. Setup re-sampler</text><polygon fill="#A80036" points="494,450.3203,504,454.3203,494,458.3203,498,454.3203" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="242" x2="500" y1="454.3203" y2="454.3203"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="176" x="249" y="449.2544">swr_alloc_set_opts(..)</text><polygon fill="#A80036" points="494,479.4531,504,483.4531,494,487.4531,498,483.4531" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="242" x2="500" y1="483.4531" y2="483.4531"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="96" x="249" y="478.3872">swr_init(..)</text><path d="M175.5,505.4531 L361.5,505.4531 L361.5,512.4531 L351.5,522.4531 L175.5,522.4531 L175.5,505.4531 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="264.1953" style="stroke:#000000;stroke-width:2.0;" width="736.5" x="175.5" y="505.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="141" x="190.5" y="518.52">4. Setup audio sink</text><polygon fill="#A80036" points="588.5,539.7188,598.5,543.7188,588.5,547.7188,592.5,543.7188" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="242" x2="594.5" y1="543.7188" y2="543.7188"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="64" x="249" y="538.6528">init(..)</text><path d="M572.5,558.7188 L679.5,558.7188 L679.5,565.7188 L669.5,575.7188 L572.5,575.7188 L572.5,558.7188 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="161.7969" style="stroke:#000000;stroke-width:2.0;" width="329.5" x="572.5" y="558.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="62" x="587.5" y="571.7856">Initialise</text><polygon fill="#A80036" points="822.5,592.9844,832.5,596.9844,822.5,600.9844,826.5,596.9844" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="610.5" x2="828.5" y1="596.9844" y2="596.9844"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="96" x="617.5" y="591.9185">SDL_Init(..)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="610.5" x2="652.5" y1="641.25" y2="641.25"/><line style="stroke:#A80036;stroke-width:1.0;" x1="652.5" x2="652.5" y1="641.25" y2="654.25"/><line style="stroke:#A80036;stroke-width:1.0;" x1="611.5" x2="652.5" y1="654.25" y2="654.25"/><polygon fill="#A80036" points="621.5,650.25,611.5,654.25,621.5,658.25,617.5,654.25" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="20" x="617.5" y="621.0513">set</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="104" x="641.5" y="621.0513">SDL_AudioSpec</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48" x="749.5" y="621.0513">options</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="617.5" y="636.1841">and buffer callback</text><polygon fill="#A80036" points="822.5,679.3828,832.5,683.3828,822.5,687.3828,826.5,683.3828" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="610.5" x2="828.5" y1="683.3828" y2="683.3828"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="136" x="617.5" y="678.3169">SDL_OpenAudio(..)</text><polygon fill="#A80036" points="822.5,708.5156,832.5,712.5156,822.5,716.5156,826.5,712.5156" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="610.5" x2="828.5" y1="712.5156" y2="712.5156"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="136" x="617.5" y="707.4497">SDL_PauseAudio(0)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="242" x2="284" y1="748.6484" y2="748.6484"/><line style="stroke:#A80036;stroke-width:1.0;" x1="284" x2="284" y1="748.6484" y2="761.6484"/><line style="stroke:#A80036;stroke-width:1.0;" x1="243" x2="284" y1="761.6484" y2="761.6484"/><polygon fill="#A80036" points="253,757.6484,243,761.6484,253,765.6484,249,761.6484" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="249" y="743.5825">create PCM buffer</text><path d="M10,783.6484 L74,783.6484 L74,790.6484 L64,800.6484 L10,800.6484 L10,783.6484 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="726.8594" style="stroke:#000000;stroke-width:2.0;" width="942" x="10" y="783.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="25" y="796.7153">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="107" x="89" y="795.8589">[control state ==</text><text fill="#000000" font-family="monospace" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="112" x="200" y="795.8589">PLAYBACK_CTRL_ON</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="312" y="795.8589">]</text><path d="M155.5,807.7813 L404.5,807.7813 L404.5,814.7813 L394.5,824.7813 L155.5,824.7813 L155.5,807.7813 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="387.7266" style="stroke:#000000;stroke-width:2.0;" width="786.5" x="155.5" y="807.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="204" x="170.5" y="820.8481">5. Decode/resample frames</text><path d="M165.5,831.9141 L241.5,831.9141 L241.5,838.9141 L231.5,848.9141 L165.5,848.9141 L165.5,831.9141 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="356.5938" style="stroke:#000000;stroke-width:2.0;" width="766.5" x="165.5" y="831.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31" x="180.5" y="844.981">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="256.5" y="844.1245">[</text><text fill="#000000" font-family="monospace" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="119" x="261.5" y="844.1245">av_read_frame(..)</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="23" x="384.5" y="844.1245">and</text><text fill="#000000" font-family="monospace" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="182" x="411.5" y="844.1245">CTUNE_PLAYER_STATE_PLAYING</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="593.5" y="844.1245">]</text><polygon fill="#A80036" points="494,866.1797,504,870.1797,494,874.1797,498,870.1797" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="242" x2="500" y1="870.1797" y2="870.1797"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="184" x="249" y="865.1138">avcodec_send_packet(..)</text><path d="M175.5,885.1797 L251.5,885.1797 L251.5,892.1797 L241.5,902.1797 L175.5,902.1797 L175.5,885.1797 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="267.1953" style="stroke:#000000;stroke-width:2.0;" width="746.5" x="175.5" y="885.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31" x="190.5" y="898.2466">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="266.5" y="897.3901">[</text><text fill="#000000" font-family="monospace" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="175" x="271.5" y="897.3901">avcodec_receive_frame(..)</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="446.5" y="897.3901">]</text><polygon fill="#A80036" points="494,919.4453,504,923.4453,494,927.4453,498,923.4453" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="242" x2="500" y1="923.4453" y2="923.4453"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="120" x="249" y="918.3794">swr_convert(..)</text><polygon fill="#A80036" points="494,948.5781,504,952.5781,494,956.5781,498,952.5781" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="242" x2="500" y1="952.5781" y2="952.5781"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="240" x="249" y="947.5122">av_samples_get_buffer_size(..)</text><polygon fill="#A80036" points="588.5,977.7109,598.5,981.7109,588.5,985.7109,592.5,981.7109" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="242" x2="594.5" y1="981.7109" y2="981.7109"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="72" x="249" y="976.645">write(..)</text><path d="M562.5,996.7109 L749.5,996.7109 L749.5,1003.7109 L739.5,1013.7109 L562.5,1013.7109 L562.5,996.7109 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="148.6641" style="stroke:#000000;stroke-width:2.0;" width="349.5" x="562.5" y="996.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="142" x="577.5" y="1009.7778">Playback PCM data</text><path d="M572.5,1020.8438 L648.5,1020.8438 L648.5,1027.8438 L638.5,1037.8438 L572.5,1037.8438 L572.5,1020.8438 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="46.2656" style="stroke:#000000;stroke-width:2.0;" width="329.5" x="572.5" y="1020.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31" x="587.5" y="1033.9106">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="210" x="663.5" y="1033.0542">[while buffer has content unread]</text><polygon fill="#A80036" points="822.5,1055.1094,832.5,1059.1094,822.5,1063.1094,826.5,1059.1094" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="610.5" x2="828.5" y1="1059.1094" y2="1059.1094"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="96" x="617.5" y="1054.0435">SDL_Delay(1)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="610.5" x2="652.5" y1="1095.2422" y2="1095.2422"/><line style="stroke:#A80036;stroke-width:1.0;" x1="652.5" x2="652.5" y1="1095.2422" y2="1108.2422"/><line style="stroke:#A80036;stroke-width:1.0;" x1="611.5" x2="652.5" y1="1108.2422" y2="1108.2422"/><polygon fill="#A80036" points="621.5,1104.2422,611.5,1108.2422,621.5,1112.2422,617.5,1108.2422" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160" x="617.5" y="1090.1763">set buffer with PCM data</text><polygon fill="#A80036" points="621.5,1133.375,611.5,1137.375,621.5,1141.375,617.5,1137.375" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="615.5" x2="833.5" y1="1137.375" y2="1137.375"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="200" x="627.5" y="1132.3091">fillAudioCallbackFunc(..)</text><polygon fill="#A80036" points="494,1176.5078,504,1180.5078,494,1184.5078,498,1180.5078" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="242" x2="500" y1="1180.5078" y2="1180.5078"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="152" x="249" y="1175.4419">av_packet_unref(..)</text><rect fill="#EEEEEE" filter="url(#f1opb2z0wqnf34)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="962" x="0" y="1223.0742"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="962" y1="1223.0742" y2="1223.0742"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="962" y1="1226.0742" y2="1226.0742"/><rect fill="#EEEEEE" filter="url(#f1opb2z0wqnf34)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="123" x="419.5" y="1212.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="104" x="425.5" y="1228.5747">Stop Playback</text><polygon fill="#A80036" points="220,1262.7734,230,1266.7734,220,1270.7734,224,1266.7734" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="56" x2="226" y1="1266.7734" y2="1266.7734"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="112" x="63" y="1261.7075">stopPlayback()</text><line style="stroke:#A80036;stroke-width:1.0;" x1="242" x2="284" y1="1295.9063" y2="1295.9063"/><line style="stroke:#A80036;stroke-width:1.0;" x1="284" x2="284" y1="1295.9063" y2="1308.9063"/><line style="stroke:#A80036;stroke-width:1.0;" x1="243" x2="284" y1="1308.9063" y2="1308.9063"/><polygon fill="#A80036" points="253,1304.9063,243,1308.9063,253,1312.9063,249,1308.9063" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="249" y="1290.8403">set state to</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="136" x="327" y="1290.8403">PLAYBACK_CTRL_OFF</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="952" y1="1317.9063" y2="1317.9063"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="107" x="15" y="1328.1167">[control state ==</text><text fill="#000000" font-family="monospace" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="119" x="126" y="1328.1167">PLAYBACK_CTRL_OFF</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="245" y="1328.1167">]</text><path d="M175.5,1338.7109 L253.5,1338.7109 L253.5,1345.7109 L243.5,1355.7109 L175.5,1355.7109 L175.5,1338.7109 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="164.7969" style="stroke:#000000;stroke-width:2.0;" width="736.5" x="175.5" y="1338.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="33" x="190.5" y="1351.7778">Stop</text><polygon fill="#A80036" points="499,1372.9766,509,1376.9766,499,1380.9766,503,1376.9766" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="242" x2="505" y1="1376.9766" y2="1376.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="249" y="1371.9106">close/free resources</text><polygon fill="#A80036" points="588.5,1402.1094,598.5,1406.1094,588.5,1410.1094,592.5,1406.1094" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="242" x2="594.5" y1="1406.1094" y2="1406.1094"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="96" x="249" y="1401.0435">shutdown(..)</text><path d="M572.5,1421.1094 L689.5,1421.1094 L689.5,1428.1094 L679.5,1438.1094 L572.5,1438.1094 L572.5,1421.1094 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="75.3984" style="stroke:#000000;stroke-width:2.0;" width="329.5" x="572.5" y="1421.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="72" x="587.5" y="1434.1763">Shutdown</text><polygon fill="#A80036" points="822.5,1455.375,832.5,1459.375,822.5,1463.375,826.5,1459.375" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="610.5" x2="828.5" y1="1459.375" y2="1459.375"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="128" x="617.5" y="1454.3091">SDL_CloseAudio()</text><polygon fill="#A80036" points="827.5,1484.5078,837.5,1488.5078,827.5,1492.5078,831.5,1488.5078" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="610.5" x2="833.5" y1="1488.5078" y2="1488.5078"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="80" x="617.5" y="1483.4419">SDL_Quit()</text><!--MD5=[e5282f0b62205c253d51713cdc0c11be]
@startuml
'https://plantuml.com/sequence-diagram

'skinparam sequenceArrowThickness 2

participant cTune as ctune
box Player #wheat
    participant "RadioPlayer" as in
    participant "FFMpeg library\n(avlib)" as ffmpeg
end box
box Audio Output #aquamarine
    participant "SDL" as out
    participant "SDL2 library" as sdl
end box

activate ctune
ctune -> in : ""init(..)""
activate in
== Start Playback ==
ctune -> in : ""playRadioStream(..)""
in -> in : set state to ""PLAYBACK_CTRL_ON""

group 1. setup stream input
    activate ffmpeg
    in -> ffmpeg : ""avformat_open_input(..)""
    in -> ffmpeg : ""avformat_find_stream_info(..)""
    in -> ffmpeg : ""av_find_best_stream(..)""
end group

group 2. Setup input codec
    in -> ffmpeg : ""avcodec_open2(..)""
end group

group 3. Setup re-sampler
    in -> ffmpeg : ""swr_alloc_set_opts(..)""
    in -> ffmpeg : ""swr_init(..)""
end group

group 4. Setup audio sink
    in -> out : ""init(..)""
    activate out
    group Initialise
        out -> sdl : ""SDL_Init(..)""
        activate sdl
        out -> out : set ""SDL_AudioSpec"" options\nand buffer callback
        out -> sdl :  ""SDL_OpenAudio(..)""
        out -> sdl :  ""SDL_PauseAudio(0)""
    end group
    in -> in : create PCM buffer
end group

alt #lightblue control state == ""PLAYBACK_CTRL_ON""
    group 5. Decode/resample frames
        loop ""av_read_frame(..)"" and ""CTUNE_PLAYER_STATE_PLAYING""
            in -> ffmpeg : ""avcodec_send_packet(..)""
            loop ""avcodec_receive_frame(..)""
                in -> ffmpeg : ""swr_convert(..)""
                in -> ffmpeg : ""av_samples_get_buffer_size(..)""
                in -> out : ""write(..)""
                group Playback PCM data
                    loop while buffer has content unread
                        out -> sdl : ""SDL_Delay(1)""
                    end loop
                    out -> out : set buffer with PCM data
                    sdl -> out : ""fillAudioCallbackFunc(..)""
                end group
            end loop
            in -> ffmpeg : ""av_packet_unref(..)""
        end loop
    end group
== Stop Playback ==
ctune -> in : ""stopPlayback()""
in -> in : set state to ""PLAYBACK_CTRL_OFF""
else #lightpink control state == ""PLAYBACK_CTRL_OFF""
    group Stop
        in -> ffmpeg : close/free resources
        deactivate ffmpeg
        in -> out : ""shutdown(..)""
        group Shutdown
            out -> sdl : ""SDL_CloseAudio()""
            out -> sdl : ""SDL_Quit()""
            deactivate sdl
        end group
        deactivate out
    end group
end group




@enduml

@startuml


participant cTune as ctune
box Player #wheat
    participant "RadioPlayer" as in
    participant "FFMpeg library\n(avlib)" as ffmpeg
end box
box Audio Output #aquamarine
    participant "SDL" as out
    participant "SDL2 library" as sdl
end box

activate ctune
ctune -> in : ""init(..)""
activate in
== Start Playback ==
ctune -> in : ""playRadioStream(..)""
in -> in : set state to ""PLAYBACK_CTRL_ON""

group 1. setup stream input
    activate ffmpeg
    in -> ffmpeg : ""avformat_open_input(..)""
    in -> ffmpeg : ""avformat_find_stream_info(..)""
    in -> ffmpeg : ""av_find_best_stream(..)""
end group

group 2. Setup input codec
    in -> ffmpeg : ""avcodec_open2(..)""
end group

group 3. Setup re-sampler
    in -> ffmpeg : ""swr_alloc_set_opts(..)""
    in -> ffmpeg : ""swr_init(..)""
end group

group 4. Setup audio sink
    in -> out : ""init(..)""
    activate out
    group Initialise
        out -> sdl : ""SDL_Init(..)""
        activate sdl
        out -> out : set ""SDL_AudioSpec"" options\nand buffer callback
        out -> sdl :  ""SDL_OpenAudio(..)""
        out -> sdl :  ""SDL_PauseAudio(0)""
    end group
    in -> in : create PCM buffer
end group

alt #lightblue control state == ""PLAYBACK_CTRL_ON""
    group 5. Decode/resample frames
        loop ""av_read_frame(..)"" and ""CTUNE_PLAYER_STATE_PLAYING""
            in -> ffmpeg : ""avcodec_send_packet(..)""
            loop ""avcodec_receive_frame(..)""
                in -> ffmpeg : ""swr_convert(..)""
                in -> ffmpeg : ""av_samples_get_buffer_size(..)""
                in -> out : ""write(..)""
                group Playback PCM data
                    loop while buffer has content unread
                        out -> sdl : ""SDL_Delay(1)""
                    end loop
                    out -> out : set buffer with PCM data
                    sdl -> out : ""fillAudioCallbackFunc(..)""
                end group
            end loop
            in -> ffmpeg : ""av_packet_unref(..)""
        end loop
    end group
== Stop Playback ==
ctune -> in : ""stopPlayback()""
in -> in : set state to ""PLAYBACK_CTRL_OFF""
else #lightpink control state == ""PLAYBACK_CTRL_OFF""
    group Stop
        in -> ffmpeg : close/free resources
        deactivate ffmpeg
        in -> out : ""shutdown(..)""
        group Shutdown
            out -> sdl : ""SDL_CloseAudio()""
            out -> sdl : ""SDL_Quit()""
            deactivate sdl
        end group
        deactivate out
    end group
end group




@enduml

PlantUML version 1.2021.7(Sun May 23 14:40:07 CEST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: Dynamic Code Evolution 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: GB
--></g></svg>